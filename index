<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ladezeit & Kosten</title>
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; max-width: 560px; margin: 24px auto; padding: 0 14px; }
    h1 { text-align: center; }
    label { display:block; margin-top: 12px; }
    input { width: 100%; padding: 10px; font-size: 16px; margin-top: 6px; }
    button { margin-top: 18px; width: 100%; padding: 12px; font-size: 17px; font-weight: 600; }
    .out { margin-top: 18px; padding: 14px; background: #f3f3f3; border-radius: 10px; line-height: 1.6; }
    small { color: #555; }
  </style>
</head>

<body>
  <h1>Ladezeit & Kosten</h1>

  <label>Akkukapazität (kWh)
    <input id="cap" type="number" step="0.1" value="69">
  </label>

  <label>Ladeleistung (kW)
    <input id="power" type="number" step="0.1" value="2">
  </label>

  <label>Ankunft (%)
    <input id="start" type="number" min="0" max="100" value="35">
  </label>

  <label>Ziel (%)
    <input id="target" type="number" min="0" max="100" value="80">
  </label>

  <label><small>Ladeverluste (%)</small>
    <input id="loss" type="number" min="0" max="50" value="12">
  </label>

  <label>Strompreis (€/kWh)
    <input id="price" type="number" step="0.01" min="0" value="0.35">
  </label>

  <button type="button" onclick="calc()">Berechnen</button>

  <div class="out" id="out">Ergebnis erscheint hier.</div>

<script>
function fmtTime(hours) {
  const totalMinutes = Math.round(hours * 60);
  const h = Math.floor(totalMinutes / 60);
  const m = totalMinutes % 60;
  return `${h} h ${String(m).padStart(2,'0')} min`;
}

function show(html) {
  document.getElementById('out').innerHTML = html;
}

function calc() {
  const cap   = Number(document.getElementById('cap').value);
  const power = Number(document.getElementById('power').value);
  const start = Number(document.getElementById('start').value);
  const target= Number(document.getElementById('target').value);
  const lossP = Number(document.getElementById('loss').value);
  const price = Number(document.getElementById('price').value);

  if (!cap || cap <= 0) return show("Kapazität muss > 0 sein.");
  if (!power || power <= 0) return show("Ladeleistung muss > 0 sein.");
  if (start < 0 || start > 100 || target < 0 || target > 100) return show("Prozentwerte müssen 0–100 sein.");
  if (target <= start) return show("Ziel muss größer als Start sein.");
  if (price < 0) return show("Strompreis muss ≥ 0 sein.");

  const energy = cap * ((target - start) / 100);
  const idealHours = energy / power;

  const loss = Math.min(Math.max(lossP, 0), 90) / 100;
  const gridEnergy = energy / (1 - loss);
  const realHours = idealHours / (1 - loss);

  const costIdeal = energy * price;
  const costReal  = gridEnergy * price;

  show(
    `Benötigte Energie (Akku): <b>${energy.toFixed(2)} kWh</b><br>` +
    `Ideale Ladezeit: <b>${fmtTime(idealHours)}</b><br><br>` +
    `Energie aus dem Netz: <b>${gridEnergy.toFixed(2)} kWh</b><br>` +
    `Ladezeit inkl. Verluste: <b>${fmtTime(realHours)}</b><br><br>` +
    `Kosten (ideal): <b>${costIdeal.toFixed(2)} €</b><br>` +
    `Kosten (realistisch): <b>${costReal.toFixed(2)} €</b>`
  );
}

calc(); // initial
</script>
</body>
</html>
